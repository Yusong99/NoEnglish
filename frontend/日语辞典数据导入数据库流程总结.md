# æ—¥è¯­è¾å…¸æ•°æ®å¯¼å…¥æ•°æ®åº“å®Œæ•´æµç¨‹æ€»ç»“

æœ¬æ–‡æ¡£æ•´ç†äº†**ä»é›¶å¼€å§‹å°†æ—¥è¯­è¾å…¸æ•°æ®å¯¼å…¥ MySQLï¼Œå¹¶é€šè¿‡ Spring Boot + JPA æä¾›æœç´¢æ¥å£**çš„å®Œæ•´è¿‡ç¨‹ï¼Œé€‚åˆä½œä¸ºä¸ªäººé¡¹ç›®æ€»ç»“æˆ–åç»­æ‰©å±•å‚è€ƒã€‚

---

## ä¸€ã€æ€»ä½“ç›®æ ‡

æ„å»ºä¸€ä¸ªã€Œç»™ä¸­å›½äººå­¦æ—¥è¯­ç”¨çš„è¾å…¸åç«¯ã€ï¼Œå®ç°ï¼š

- ğŸ“¥ å°†æ—¥è¯­è¯å…¸æ•°æ®æ‰¹é‡å¯¼å…¥æ•°æ®åº“
- ğŸ—„ ä½¿ç”¨ MySQL ä½œä¸ºå­˜å‚¨
- âš™ï¸ ä½¿ç”¨ Spring Boot + JPA ä½œä¸ºåç«¯
- ğŸ” æä¾›å…³é”®è¯æœç´¢æ¥å£ï¼ˆè¯ / å‡å / é‡Šä¹‰ï¼‰

---

## äºŒã€æ•°æ®åº“è®¾è®¡

### 1ï¸âƒ£ è¡¨ç»“æ„è®¾è®¡ï¼ˆwords è¡¨ï¼‰

```sql
CREATE TABLE words (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    word VARCHAR(100) COMMENT 'è¡¨è®°ï¼ˆæ±‰å­—/å‡åï¼‰',
    reading VARCHAR(100) COMMENT 'è¯»éŸ³ï¼ˆå‡åï¼‰',
    meaning TEXT COMMENT 'ä¸­æ–‡é‡Šä¹‰',
    pos TEXT COMMENT 'è¯æ€§ï¼ˆå¤šä¸ªï¼‰'
) CHARACTER SET utf8mb4;
```

è®¾è®¡è¯´æ˜ï¼š

- `id`ï¼šä¸»é”®ï¼ŒJPA å¿…é¡»
- `word`ï¼šå¦‚ã€Œå‹‰å¼·ã€ã€Œã‚ã®äººã€
- `reading`ï¼šå¦‚ã€Œã¹ã‚“ãã‚‡ã†ã€ã€Œã‚ã®ã²ã¨ã€
- `meaning`ï¼šä¸­æ–‡è§£é‡Šï¼ˆé•¿åº¦ä¸å›ºå®šï¼Œç”¨ TEXTï¼‰
- `pos`ï¼šè¯æ€§ä¿¡æ¯ï¼Œå¯èƒ½å¾ˆé•¿ï¼Œç”¨ TEXTï¼ˆé¿å… Data too long é”™è¯¯ï¼‰

---

## ä¸‰ã€Python å¯¼å…¥è„šæœ¬ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰

brew install python
python3 --version
pip3 --version

# è¿›å…¥æ‚¨çš„é¡¹ç›®ç›®å½•ï¼ˆä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå®‰è£…pymysqlï¼‰

# cd ~/my_project_folder

python3 -m venv my_env
source my_env/bin/activate
pip install PyMySQL
python main.py
deactivate ï¼ˆé€€å‡ºè™šæ‹Ÿç¯å¢ƒï¼‰

### 1ï¸âƒ£ ä½¿ç”¨ PyMySQL è¿æ¥æ•°æ®åº“

```python
import pymysql

conn = pymysql.connect(
    host='localhost',
    user='root',
    password='ä½ çš„å¯†ç ',
    database='japanese_dict',
    charset='utf8mb4'
)

cursor = conn.cursor()
```

---

### 2ï¸âƒ£ è§£æè¯å…¸æ–‡æœ¬ï¼ˆç¤ºä¾‹æ ¼å¼ï¼‰

```text
[31] ã‚ã®äºº (ã‚ã®ã²ã¨) - ä»–ï¼Œé‚£ä¸ªäºº
[32] ã‚ã®æ–¹ (ã‚ã®ã‹ãŸ) - é‚£ä½å…ˆç”Ÿ
```

---

### 3ï¸âƒ£ æ’å…¥æ•°æ®åº“ï¼ˆå¯ç›´æ¥è·‘ï¼‰

```python
sql = """
INSERT INTO words (word, reading, meaning, pos)
VALUES (%s, %s, %s, %s)
"""

with open('dict.txt', 'r', encoding='utf-8') as f:
    for line in f:
        line = line.strip()
        if not line:
            continue

        # ç¤ºä¾‹è§£æï¼ˆæ ¹æ®ä½ è‡ªå·±çš„æ ¼å¼å¾®è°ƒï¼‰
        try:
            left, meaning = line.split(' - ', 1)
            word_part = left.split(']')[1].strip()

            if '(' in word_part:
                word, reading = word_part.split('(', 1)
                reading = reading.replace(')', '').strip()
            else:
                word = word_part
                reading = ''

            cursor.execute(sql, (
                word.strip(),
                reading,
                meaning,
                ''
            ))
        except Exception as e:
            print('è·³è¿‡ï¼š', line)

conn.commit()
cursor.close()
conn.close()
```

ğŸ“Œ æ³¨æ„ç‚¹ï¼š

- ä¸€å®šè¦ä½¿ç”¨ `utf8mb4`
- `pos` å­—æ®µå¦‚æœå¤ªçŸ­ä¼šå¯¼è‡´ `Data too long for column 'pos'`

---

## å››ã€Spring Boot å®ä½“ç±»ï¼ˆWordï¼‰

âš ï¸ **JPA å®ä½“å¿…é¡»æœ‰ @Id**

```java
@Entity
@Table(name = "words")
@Getter
@Setter
public class Word {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(length = 100)
    private String word;

    @Column(length = 100)
    private String reading;

    @Column(columnDefinition = "TEXT")
    private String meaning;

    @Column(columnDefinition = "TEXT")
    private String pos;
}
```

â— å¸¸è§é”™è¯¯ï¼š

- âŒ ä½¿ç”¨ `org.springframework.data.annotation.Id`
- âœ… å¿…é¡»ä½¿ç”¨ `jakarta.persistence.Id`

---

## äº”ã€Repositoryï¼ˆJPA æœç´¢æ ¸å¿ƒï¼‰

```java
public interface WordRepository extends JpaRepository<Word, Long> {

    @Query("""
        select w from Word w
        where w.word like %:kw%
           or w.reading like %:kw%
           or w.meaning like %:kw%
    """)
    List<Word> search(@Param("kw") String keyword);
}
```

è¯´æ˜ï¼š

- ä½¿ç”¨ JPQLï¼ˆä¸æ˜¯ SQLï¼‰
- `Word` æ˜¯å®ä½“åï¼Œä¸æ˜¯è¡¨å

---

## å…­ã€Service å±‚ï¼ˆå¿…é¡»è¢« Spring ç®¡ç†ï¼‰

```java
@Service
public class WordServiceImpl implements WordService {

    private final WordRepository wordRepository;

    public WordServiceImpl(WordRepository wordRepository) {
        this.wordRepository = wordRepository;
    }

    @Override
    public List<Word> search(String keyword) {
        return wordRepository.search(keyword);
    }
}
```

âš ï¸ å¦‚æœæ²¡æœ‰ `@Service`ï¼Œä¼šå¯¼è‡´ï¼š

```text
NullPointerException: wordRepository is null
```

---

## ä¸ƒã€Controller æœç´¢æ¥å£

```java
@RestController
@RequestMapping("/api/words")
public class WordController {

    private final WordService wordService;

    public WordController(WordService wordService) {
        this.wordService = wordService;
    }

    @GetMapping("/search")
    public List<Word> search(@RequestParam String keyword) {
        return wordService.search(keyword);
    }
}
```

è¯·æ±‚ç¤ºä¾‹ï¼š

```
GET /api/words/search?keyword=ã‚ã®
```

---

## å…«ã€å¸¸è§å‘ä½æ€»ç»“ï¼ˆéå¸¸é‡è¦ï¼‰

### âŒ Entity æŠ¥é”™æ²¡æœ‰ä¸»é”®

åŸå› ï¼š

- æ²¡æœ‰ `@Id`
- æˆ–ç”¨äº†é”™è¯¯çš„ `Id` æ³¨è§£

---

### âŒ Repository ä¸º null

åŸå› ï¼š

- Service æ²¡æœ‰ `@Service`
- æ‰‹åŠ¨ `new` äº† Service

---

### âŒ æ•°æ®åº“æœ‰ SQL æ—¥å¿—ä½†è¡¨é‡Œæ²¡æ•°æ®

åŸå› ï¼š

- è¿é”™æ•°æ®åº“
- Hibernate è‡ªåŠ¨åˆ›å»ºäº†æ–°è¡¨ï¼ˆå¦‚ `users` â†’ `user`ï¼‰

---

## ä¹ã€ä¸‹ä¸€æ­¥å¯æ‰©å±•æ–¹å‘

- ğŸ” åˆ†é¡µæœç´¢ï¼ˆPageableï¼‰
- â­ æ”¶è—è¯æ±‡
- ğŸ§  è®°å¿†æ›²çº¿ / ç”Ÿè¯æœ¬
- ğŸ”Š å‘éŸ³ï¼ˆTTS / éŸ³é¢‘ï¼‰
- ğŸ‡¨ğŸ‡³â†’ğŸ‡¯ğŸ‡µ / ğŸ‡¯ğŸ‡µâ†’ğŸ‡¨ğŸ‡³ åŒå‘æœç´¢

---

## åã€ä¸€å¥è¯æ€»ç»“

> **è¿™å¥—æµç¨‹ = çœŸå®å¯ä¸Šçº¿è¾å…¸åç«¯çš„æœ€å°é—­ç¯**

ä½ å·²ç»å®Œæˆäº†ï¼š

âœ” æ•°æ®å·¥ç¨‹
âœ” JPA å®æˆ˜
âœ” æœç´¢æ¥å£
âœ” æ—¥è¯­å­¦ä¹  App çš„æ ¸å¿ƒåŸºç¡€

åé¢åš UIã€æœç´¢ä½“éªŒã€è®°å¿†ç³»ç»Ÿï¼Œéƒ½æ˜¯åœ¨è¿™ä¸ªåœ°åŸºä¸Šå¾€ä¸Šç›–æ¥¼ ğŸš€
